<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">
<title>Miami-Dade Transit Ticket</title>

<style>
    body {
        margin: 0;
        font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
        background-color: rgba(0,0,0,0.4);
        display: flex;
        justify-content: center;
        align-items: center;
        height: 100dvh;
        padding: env(safe-area-inset-top) env(safe-area-inset-right) 
                 env(safe-area-inset-bottom) env(safe-area-inset-left);
        box-sizing: border-box;
    }

    .modal {
        position: relative;
        width: 95vw;
        max-width: 430px;
        height: 92vh;
        max-height: 900px;
        background: white;
        border-radius: 32px;
        padding: 24px;
        display: flex;
        flex-direction: column;
        align-items: center;
        overflow: hidden;
        box-shadow: 0 8px 24px rgba(0,0,0,0.3);
    }

    .close-btn {
        position: absolute;
        top: 18px;
        right: 18px;
        font-size: 28px;
        font-weight: bold;
        cursor: pointer;
        color: #666;
    }

    .title {
        width: 100%;
        text-align: left;
        font-size: clamp(20px, 5vw, 28px);
        font-weight: 700;
    }

    .subtitle {
        width: 100%;
        text-align: left;
        font-size: clamp(14px, 4vw, 18px);
        color: #555;
        margin-bottom: 10px;
    }

    /* === QR AREA === */
    .qr-container {
        width: min(70vw, 320px);
        height: min(70vw, 320px);
        margin: 10px auto;
    }

    .qr-container img {
        width: 100%;
        height: 100%;
        border-radius: 16px;
        object-fit: cover;
        box-shadow: 0 4px 12px rgba(0,0,0,0.15);
    }

    /* === LOGO / ANIMATION === */
    .logo-wrapper {
        position: relative;
        width: min(40vw, 150px);
        height: min(40vw, 150px);
        border-radius: 50%;
        overflow: hidden; /* ensures circle is never clipped to a square */
        margin-bottom: 10px;
    }

    canvas {
        position: absolute;
        inset: 0;
        width: 100%;
        height: 100%;
        border-radius: 50%; /* circle always stays round */
        pointer-events: none;
    }

    .circle-logo {
        width: 60%;
        height: 60%;
        border-radius: 50%;
        overflow: hidden;
        position: absolute;
        top: 20%;
        left: 20%;
        z-index: 2;
    }

    .circle-logo img {
        width: 100%;
        height: 100%;
        object-fit: cover;
    }

    .time {
        font-weight: bold;
        font-size: clamp(26px, 7vw, 46px);
        color: #3d3f42;
        margin-bottom: 10px;
        text-align: center;
        letter-spacing: 1px;
    }

    .ticket-info {
        width: 100%;
        padding: 20px;
        margin-top: auto;
        background: white;
        border-radius: 8px;
        box-shadow: 0 4px 6px rgba(0,0,0,0.18), 
                    0 1px 2px rgba(0,0,0,0.05);
    }

    .ride-type {
        font-size: clamp(18px, 5vw, 24px);
        margin: 6px 0;
    }

    .county {
        font-size: clamp(10px, 3vw, 14px);
        color: #666;
        margin: 0;
    }

    /* Expiration removed on purpose */
</style>
</head>
<body>

<div class="modal">

    <div class="close-btn" onclick="document.querySelector('.modal').style.display='none'">Ã—</div>

    <div class="title">Miami-Dade Transit</div>
    <div class="subtitle">Scan your ticket</div>

    <!-- QR CODE (replaced) -->
    <div class="qr-container">
        <img src="https://docs.lightburnsoftware.com/legacy/img/QRCode/ExampleCode.png" alt="QR Code">
    </div>

    <!-- CIRCULAR ANIMATED LOGO -->
    <div class="logo-wrapper">
        <canvas id="logoCanvas"></canvas>

        <div class="circle-logo">
            <img src="https://storage.googleapis.com/token-transit.appspot.com/_p4CVUWgAXVxP9pk2xJLSIJbxo89WPvy6ZEKIYJ__yg-logo.miamidadefl.png">
        </div>
    </div>

    <div class="time" id="time"></div>

    <div class="ticket-info">
        <p class="ride-type">Regular 1 Ride</p>
        <p class="county">Miami-Dade County, FL</p>
    </div>

</div>

<script>
/* ===========================
   LIVE TIME
=========================== */
function updateTime() {
    const now = new Date();
    let h = now.getHours();
    let m = now.getMinutes().toString().padStart(2,"0");
    let s = now.getSeconds().toString().padStart(2,"0");
    const ampm = h >= 12 ? "PM" : "AM";
    h = h % 12 || 12;
    document.getElementById("time").textContent = `${h}:${m}:${s} ${ampm}`;
}
setInterval(updateTime, 1000);
updateTime();

/* ===========================
   PERFECT CIRCLE PULSE
=========================== */
const canvas = document.getElementById("logoCanvas");
const ctx = canvas.getContext("2d");

function resizeCanvas() {
    canvas.width = canvas.offsetWidth;
    canvas.height = canvas.offsetHeight;
}
resizeCanvas();
window.addEventListener("resize", resizeCanvas);

let radius = 45;       // starting radius
let growing = true;
const minR = 45;
const maxR = 75;
const speed = 0.25;

function animate() {
    ctx.clearRect(0,0,canvas.width,canvas.height);

    ctx.beginPath();
    ctx.arc(canvas.width/2, canvas.height/2, radius, 0, Math.PI * 2);
    ctx.fillStyle = "rgb(40,94,147)";
    ctx.fill();

    if (growing) {
        radius += speed;
        if (radius >= maxR) growing = false;
    } else {
        radius -= speed;
        if (radius <= minR) growing = true;
    }

    requestAnimationFrame(animate);
}
animate();
</script>

</body>
</html>
